{
  "modeloDatos": {
    "version": "1.0.32",
    "aplicacion": "NRD Operaciones",
    "descripcion": "Sistema de Gestión Operativa",
    "fechaActualizacion": "2024-12-19",
    
    "nodosFirebase": [
      "eventos",
      "fcm_tokens", 
      "ordenes",
      "productos",
      "proveedores",
      "recetas-costos",
      "tareas",
      "users"
    ],
    
    "entidades": {
      "User": {
        "descripcion": "Usuario del sistema",
        "nodoFirebase": "users",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único del usuario"
          },
          "username": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre de usuario"
          },
          "email": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Correo electrónico del usuario"
          },
          "displayName": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Nombre para mostrar (opcional)"
          },
          "role": {
            "tipo": "enum",
            "valores": ["ADMIN", "PRODUCTOR"],
            "requerido": false,
            "descripcion": "Rol del usuario en el sistema"
          },
          "contactId": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "ID del contacto asociado (solo para PRODUCTOR)"
          },
          "createdAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de creación"
          },
          "updatedAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de última actualización"
          }
        }
      },
      
      "Orden": {
        "descripcion": "Orden de productos",
        "nodoFirebase": "ordenes",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único de la orden"
          },
          "proveedorId": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "ID del proveedor"
          },
          "proveedorNombre": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del proveedor"
          },
          "fecha": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de la orden"
          },
          "tipo": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Tipo de orden ('Normal', 'Producción', etc.)"
          },
          "estado": {
            "tipo": "enum",
            "valores": ["PENDIENTE", "ENVIADA / IMPRESA", "COMPLETADA", "RECHAZADA"],
            "requerido": true,
            "descripcion": "Estado actual de la orden"
          },
          "productos": {
            "tipo": "array",
            "elemento": "ProductoOrden",
            "requerido": true,
            "descripcion": "Lista de productos en la orden"
          },
          "total": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Total de la orden"
          },
          "observaciones": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Observaciones adicionales"
          },
          "createdAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de creación"
          }
        }
      },
      
      "ProductoOrden": {
        "descripcion": "Producto dentro de una orden",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Identificador único del producto en la orden"
          },
          "productoId": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "ID del producto original"
          },
          "nombre": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del producto"
          },
          "cantidad": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Cantidad solicitada"
          },
          "unidad": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Unidad de medida"
          },
          "precio": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Precio unitario"
          }
        }
      },
      
      "Producto": {
        "descripcion": "Producto del catálogo",
        "nodoFirebase": "productos",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único del producto"
          },
          "nombre": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del producto"
          },
          "precio": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Precio del producto"
          },
          "stock": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Stock disponible"
          },
          "unidad": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Unidad de medida"
          },
          "proveedorId": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "ID del proveedor"
          },
          "proveedorNombre": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del proveedor"
          },
          "orden": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Orden de visualización"
          },
          "archivado": {
            "tipo": "boolean",
            "requerido": true,
            "descripcion": "Si el producto está archivado"
          },
          "fueraDeTemporada": {
            "tipo": "boolean",
            "requerido": false,
            "descripcion": "Si está fuera de temporada"
          },
          "fueraDeTemporadaHasta": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Fecha hasta cuando está fuera de temporada"
          },
          "costoTotal": {
            "tipo": "number",
            "requerido": false,
            "descripcion": "Costo total calculado de la receta"
          },
          "createdAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de creación"
          }
        }
      },
      
      "Proveedor": {
        "descripcion": "Proveedor de productos",
        "nodoFirebase": "proveedores",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único del proveedor"
          },
          "nombre": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del proveedor"
          },
          "celular": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Número de celular"
          },
          "telefono": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Número de teléfono"
          },
          "email": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Correo electrónico"
          },
          "direccion": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Dirección física"
          },
          "frecuencia": {
            "tipo": "object",
            "requerido": false,
            "descripcion": "Configuración de frecuencia de pedidos",
            "campos": {
              "tipo": "string",
              "valor": "string",
              "diaSemana": "string",
              "diaMes": "string",
              "diasSemana": "array"
            }
          },
          "tipo": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Tipo de proveedor"
          },
          "salarioPorDia": {
            "tipo": "number",
            "requerido": false,
            "descripcion": "Salario por día"
          },
          "productosDefault": {
            "tipo": "array",
            "requerido": false,
            "descripcion": "Lista de productos predeterminados",
            "elemento": {
              "productoId": "string",
              "cantidad": "string",
              "unidad": "string"
            }
          },
          "createdAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de creación"
          },
          "updatedAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de última actualización"
          }
        }
      },
      
      "Tarea": {
        "descripcion": "Tarea del sistema",
        "nodoFirebase": "tareas",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único de la tarea"
          },
          "titulo": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Título de la tarea"
          },
          "descripcion": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Descripción detallada"
          },
          "prioridad": {
            "tipo": "enum",
            "valores": ["alta", "media", "baja"],
            "requerido": true,
            "descripcion": "Prioridad de la tarea"
          },
          "completada": {
            "tipo": "boolean",
            "requerido": true,
            "descripcion": "Si la tarea está completada"
          },
          "asignadaA": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "UID del usuario asignado"
          },
          "usuarioAsignado": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del usuario asignado"
          },
          "observacion": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Observaciones adicionales"
          },
          "fechaCompletada": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Fecha de completado"
          },
          "seguidores": {
            "tipo": "array",
            "requerido": false,
            "descripcion": "IDs de usuarios seguidores"
          },
          "publica": {
            "tipo": "boolean",
            "requerido": false,
            "descripcion": "Si es visible para todos"
          },
          "createdAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de creación"
          }
        }
      },
      
      "IngredienteCosto": {
        "descripcion": "Ingrediente en una receta de costo",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único del ingrediente"
          },
          "tipo": {
            "tipo": "enum",
            "valores": ["producto", "personalizado"],
            "requerido": true,
            "descripcion": "Tipo de ingrediente"
          },
          "productoId": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "ID del producto si tipo es 'producto'"
          },
          "nombre": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del ingrediente"
          },
          "cantidad": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Cantidad utilizada en la receta"
          },
          "unidad": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Unidad de la cantidad"
          },
          "precioUnitario": {
            "tipo": "number",
            "requerido": false,
            "descripcion": "Precio por unidad del producto"
          },
          "porcentaje": {
            "tipo": "number",
            "requerido": false,
            "descripcion": "Porcentaje del precio unitario"
          },
          "costo": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Costo calculado"
          },
          "observaciones": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Observaciones adicionales"
          }
        }
      },
      
      "RecetaCosto": {
        "descripcion": "Receta de costos para un producto",
        "nodoFirebase": "recetas-costos",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único de la receta"
          },
          "productoId": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "ID del producto al que pertenece"
          },
          "nombre": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Nombre del producto"
          },
          "ingredientes": {
            "tipo": "array",
            "elemento": "IngredienteCosto",
            "requerido": true,
            "descripcion": "Lista de ingredientes"
          },
          "costoTotal": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Suma de todos los costos"
          },
          "rendimiento": {
            "tipo": "number",
            "requerido": false,
            "descripcion": "Cantidad de producto final que produce"
          },
          "costoPorUnidad": {
            "tipo": "number",
            "requerido": false,
            "descripcion": "Costo total dividido por rendimiento"
          },
          "observaciones": {
            "tipo": "string",
            "requerido": false,
            "descripcion": "Observaciones adicionales"
          },
          "createdAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de creación"
          },
          "updatedAt": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Fecha de última actualización"
          }
        }
      },
      
      "Evento": {
        "descripcion": "Evento del sistema",
        "nodoFirebase": "eventos",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único del evento"
          },
          "tipo": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Tipo de evento"
          },
          "descripcion": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Descripción del evento"
          },
          "usuarioId": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "ID del usuario que generó el evento"
          },
          "data": {
            "tipo": "object",
            "requerido": false,
            "descripcion": "Datos adicionales del evento"
          },
          "timestamp": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Timestamp del evento"
          }
        }
      },
      
      "FCMToken": {
        "descripcion": "Token de Firebase Cloud Messaging",
        "nodoFirebase": "fcm_tokens",
        "campos": {
          "id": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Identificador único del token"
          },
          "userId": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "ID del usuario propietario del token"
          },
          "token": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Token FCM"
          },
          "platform": {
            "tipo": "string",
            "requerido": true,
            "descripcion": "Plataforma (ios/android)"
          },
          "isActive": {
            "tipo": "boolean",
            "requerido": true,
            "descripcion": "Si el token está activo"
          },
          "lastUsed": {
            "tipo": "number",
            "requerido": false,
            "descripcion": "Última vez que se usó el token"
          },
          "createdAt": {
            "tipo": "number",
            "requerido": true,
            "descripcion": "Fecha de creación del token"
          }
        }
      }
    },
    
    "relaciones": {
      "User-Proveedor": {
        "tipo": "1:1",
        "descripcion": "Los usuarios PRODUCTOR tienen un contactId que los vincula con un proveedor"
      },
      "Orden-Proveedor": {
        "tipo": "N:1",
        "descripcion": "Muchas órdenes pueden pertenecer a un proveedor"
      },
      "Orden-ProductoOrden": {
        "tipo": "1:N",
        "descripcion": "Una orden puede tener múltiples productos"
      },
      "ProductoOrden-Producto": {
        "tipo": "N:1",
        "descripcion": "Los productos de orden referencian productos existentes"
      },
      "Producto-Proveedor": {
        "tipo": "N:1",
        "descripcion": "Los productos pertenecen a un proveedor"
      },
      "RecetaCosto-Producto": {
        "tipo": "1:1",
        "descripcion": "Cada producto puede tener una receta de costos"
      },
      "RecetaCosto-IngredienteCosto": {
        "tipo": "1:N",
        "descripcion": "Una receta tiene múltiples ingredientes"
      },
      "User-FCMToken": {
        "tipo": "1:N",
        "descripcion": "Un usuario puede tener múltiples tokens FCM"
      },
      "User-Evento": {
        "tipo": "1:N",
        "descripcion": "Un usuario puede generar múltiples eventos"
      }
    }
  }
}
